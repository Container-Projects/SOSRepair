--- main/streams/streams.c	2017-02-26 11:48:02.390283533 -0500
+++ /home/afsoon/results/php-final/php-bug-2011-12-10-74343ca506-52c36e60c4/patches/patch0.c	2017-02-22 14:42:00.690250007 -0500
@@ -986,8 +986,10 @@
 
 		php_stream_fill_read_buffer(stream, len + toread TSRMLS_CC);
 
-		just_read = (stream->writepos - stream->readpos) - len;
-		len += just_read;
+		{
+		len++;
+	}
+;
 
 		/* read operation have less data than request; assume the stream is
 		 * temporarily or permanently out of data */

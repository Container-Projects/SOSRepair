diff --git a/ext/phar/phar.c b/ext/phar/phar.c
index ef7936b..1b4237f 100644
--- a/ext/phar/phar.c
+++ b/ext/phar/phar.c
@@ -1570,13 +1570,17 @@ static int phar_open_from_fp(php_stream* fp, char *fname, int fname_len, char *a
 	const char gz_magic[] = "\x1f\x8b\x08";
 	const char bz_magic[] = "BZh";
 	char *pos, test = '\0';
-	const int window_size = 1024 + sizeof(token);
+	int window_size = 1024 + sizeof(token);
 	char buffer[1024 + sizeof(token)]; /* a 1024 byte window + the size of the halt_compiler token (moving window) */
 	const long readsize = sizeof(buffer) - sizeof(token);
 	const long tokenlen = sizeof(token) - 1;
 	long halt_offset;
 	size_t got;
 	php_uint32 compression = PHAR_FILE_COMPRESSED_NONE;
+{
+		window_size = 1024;
+	}
+
 
 	if (error) {
 		*error = NULL;

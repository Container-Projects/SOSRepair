diff --git a/main/php_variables.c b/main/php_variables.c
index f544b7a..00973cb 100644
--- a/main/php_variables.c
+++ b/main/php_variables.c
@@ -133,6 +133,10 @@ PHPAPI void php_register_variable_ex(char *var_name, zval *val, zval *track_vars
 
 				if (track_vars_array) {
 					ht = Z_ARRVAL_P(track_vars_array);
+use_heap = 0;
+	var_len = 1;
+	sapi_initialize_empty_request(TSRMLS_C);
+
 					zend_hash_del(ht, var, var_len + 1);
 				}
 
